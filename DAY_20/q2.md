
#### \#\# Hard: Find the Median from a Data Stream

```cpp
#include <iostream>
#include <vector>
#include <queue>
#include <iomanip> // For std::fixed and std::setprecision

using namespace std;

class MedianFinder {
private:
    priority_queue<int> lower_half; // Max-heap for the smaller half
    priority_queue<int, vector<int>, greater<int>> upper_half; // Min-heap for the larger half

public:
    void addNum(int num) {
        lower_half.push(num); // Add to max-heap

        // Balance the heaps: ensure all elements in lower_half <= all elements in upper_half
        upper_half.push(lower_half.top());
        lower_half.pop();

        // Balance the sizes: ensure lower_half has equal or one more element
        if (upper_half.size() > lower_half.size()) {
            lower_half.push(upper_half.top());
            upper_half.pop();
        }
    }

    double findMedian() {
        if (lower_half.size() > upper_half.size()) {
            // Odd number of elements: median is the top of the larger heap
            return lower_half.top();
        } else {
            // Even number of elements: median is the average of the two tops
            return (lower_half.top() + upper_half.top()) / 2.0;
        }
    }
};

int main() {
    MedianFinder mf;
    mf.addNum(1);
    mf.addNum(2);
    cout << "Median is: " << mf.findMedian() << endl; // (1+2)/2 = 1.5
    mf.addNum(3);
    cout << "Median is: " << mf.findMedian() << endl; // 2
    mf.addNum(4);
    cout << "Median is: " << mf.findMedian() << endl; // (2+3)/2 = 2.5
    return 0;
}
```

-----
